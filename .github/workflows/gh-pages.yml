name: Deploy React App to GitHub Pages

on:
    push:
        branches:
            - master # Replace with your main branch name

    workflow_dispatch:

permissions:
    contents: read
    pages: write
    id-token: write

concurrency:
    group: "pages"
    cancel-in-progress: false

jobs:
    # Build job
    build:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v3

            - name: Setup Node.js
              uses: actions/setup-node@v3
              with:
                  node-version: "20.3.2" # Specify the version you need

            - name: Install Node.js dependencies
              run: npm install

            - name: Build React App
              run: npm run build # Adjust the command based on your project setup

            - name: Setup Pages
              uses: actions/configure-pages@v3

            - name: Upload artifact
              uses: actions/upload-artifact@v2
              with:
                  name: build
                  path: build # Change this if your build output directory is different

    # Deployment job
    deploy:
        environment:
            name: GitHub Pages
            url: ${{ steps.deployment.outputs.page_url }}

        runs-on: ubuntu-latest
        needs: build
        steps:
            - name: Deploy to GitHub Pages
              id: deployment
              uses: actions/deploy-pages@v2
              with:
                  # Specify the branch to deploy, e.g., 'gh-pages' or 'main'
                  target_branch: master
                  # Specify the directory containing the build output
                  folder: build
